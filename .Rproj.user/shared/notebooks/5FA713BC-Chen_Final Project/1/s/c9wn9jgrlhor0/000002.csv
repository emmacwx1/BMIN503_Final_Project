"0","# Run FlowSOM on the t-SNE axes"
"0","tSNE.data.mat <- as.matrix(tSNE.data)"
"0",""
"0","# create flowFrame"
"0","metadata <-"
"0","  data.frame(name = dimnames(tSNE.data.mat)[[2]],"
"0","             desc = paste('t-SNE', dimnames(tSNE.data.mat)[[2]]))"
"0","metadata$range <- apply(apply(tSNE.data.mat , 2, range), 2, diff)"
"0","metadata$minRange <- apply(tSNE.data.mat , 2, min)"
"0","metadata$maxRange <- apply(tSNE.data.mat , 2, max)"
"0","tSNE.flowframe <- new(""flowFrame"","
"0","                      exprs = tSNE.data.mat ,"
"0","                      parameters = AnnotatedDataFrame(metadata))"
"0",""
"0","# implement the FlowSOM on t-SNE data"
"0","fSOM.t <-"
"0","  FlowSOM("
"0","    tSNE.flowframe,"
"0","    compensate = FALSE,"
"0","    transform = FALSE,"
"0","    toTransform = c(1:2),"
"0","    scale = TRUE,"
"0","    colsToUse = c(1:2),"
"0","    xdim = 10,"
"0","    ydim = 10,"
"0","    nClus = 20,"
"0","    seed = overall_seed"
"0","  )"
"0","tSNE.FlowSOM.clusters <-"
"0","  as.matrix(fSOM.t[[2]][fSOM.t[[1]]$map$mapping[, 1]])"
"0",""
"0","# plot t-SNE with FlowSOM clusters"
"0","ggplot(tSNE.plot) + coord_fixed(ratio = graphical.ratio.t) + "
"0","  geom_point(aes(x = x, y = y, color = tSNE.FlowSOM.clusters), cex = 1.5) + "
"0","  labs(x = ""t-SNE 1"", y = ""t-SNE 2"", title = ""FlowSOM Clustering on t-SNE Axes"", "
"0","       color = ""FlowSOM Cluster"") + theme_bw() + "
"0","  guides(colour = guide_legend(override.aes = list(size=5))) +"
"0","  labs(caption = ""Data from Divij Mathew/Wherry Lab"")"
